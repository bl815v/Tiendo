<div class="content-header">
    <h2>‚ûï Agregar Categor√≠a</h2>
    <button onclick="window.location.reload()" class="btn-refresh">üîÑ Refrescar</button>
</div>

<div class="form-container">
    <form id="add-category-form" class="admin-form">
        <div class="form-group">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" name="nombre" required class="form-input">
        </div>

        <div class="form-group">
            <label for="descripcion">Descripci√≥n:</label>
            <textarea id="descripcion" name="descripcion" rows="3" class="form-input"></textarea>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-primary">Guardar Categor√≠a</button>
            <button type="button" onclick="window.adminCloseModal()" class="btn-secondary">Cancelar</button>
        </div>
    </form>
</div>

<script>
    document.getElementById('add-category-form').addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = {
            nombre: document.getElementById('nombre').value.trim(),
            descripcion: document.getElementById('descripcion').value.trim()
        };

        if (!formData.nombre) {
            alert('‚ùå El nombre es requerido');
            return;
        }

        try {
            const response = await fetch('/api/v1/categorias/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            });

            const result = await response.json();

            if (response.ok) {
                alert(`‚úÖ Categor√≠a "${result.nombre}" agregada exitosamente (ID: ${result.id_categoria})`);
                document.getElementById('add-category-form').reset();
            } else {
                alert(`‚ùå Error: ${result.detail || 'Error desconocido'}`);
            }
        } catch (error) {
            console.error('Error:', error);
            alert('‚ùå Error de conexi√≥n con el servidor');
        }
    });
</script>